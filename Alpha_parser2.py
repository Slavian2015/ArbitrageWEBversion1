import json
import random
import os
import pandas as pd

##################################   SHOW ALL ROWS & COLS   ####################################
pd.set_option('display.max_columns', None)
pd.set_option('display.max_rows', None)
pd.set_option('display.expand_frame_repr', False)
pd.set_option('max_colwidth', -1)

# file1 = open("proxies.txt", "r")
# PROXIES2 = file1.readlines()
#
# # print(PROXIES2[1])
#
# # PROXIES2 = PROXIES2.replace("'", "'")
#
# for i in PROXIES2:
#     print(i)
#
# numberList = ['202.150.143.59:55978', '190.211.115.66:30518', '122.54.227.188:8080', '51.68.90.232:9090', '36.92.178.99:55443', '1.20.101.149:44778', '103.240.161.109:6666', '116.212.129.58:52659', '95.170.200.138:8080', '110.74.195.215:44975', '74.59.132.126:49073', '36.67.108.153:60762', '18.237.91.70:3128', '186.226.171.94:54480', '91.203.114.74:48058', '186.42.186.202:56569', '119.252.160.165:3128', '36.67.223.67:57877', '103.27.141.8:43295', '200.174.158.26:34112', '103.107.92.193:35173', '178.134.208.126:50297', '45.165.131.12:8080', '212.142.116.146:38523', '185.158.127.9:53281', '85.52.217.114:60301', '49.248.154.237:80', '81.174.11.159:49733', '23.137.128.122:41549', '176.104.52.46:47578', '91.109.198.48:30889', '41.217.217.60:47981', '213.6.227.38:54796', '177.94.206.67:60666', '147.78.163.38:8080', '182.52.51.43:49699', '41.169.11.210:45088', '77.94.144.162:3128', '159.224.166.129:51020', '125.162.241.175:8080', '89.175.188.58:56263', '202.165.47.26:8080', '202.166.196.28:50153', '78.8.45.68:8080', '103.111.94.26:8080', '81.163.43.236:41258', '190.152.71.230:54354', '138.255.220.72:52982', '203.173.93.20:59661', '191.103.254.125:51869', '45.64.179.74:53281', '198.50.152.64:23500', '36.91.45.10:61675', '46.35.249.189:31196', '14.201.234.2:47648', '192.140.42.81:52818', '117.196.238.151:56841', '91.205.51.27:49805', '103.87.236.46:41183', '160.119.131.114:33854', '178.252.80.226:51894', '37.75.129.178:55140', '177.139.193.145:37929', '118.151.209.214:46327', '185.104.252.9:9090', '108.61.186.207:8080', '103.94.171.134:46276', '148.77.34.196:48521', '179.127.241.18:58324', '186.42.175.138:35150', '185.74.39.95:41258', '185.189.102.153:60744', '103.83.118.34:55443', '113.53.29.218:31829', '203.162.21.216:8080', '95.143.8.182:57169', '158.140.167.148:53281', '186.159.3.193:56861', '201.193.180.14:61892', '103.209.176.159:40989', '103.216.95.16:61755', '176.98.76.203:40328', '122.248.45.35:53281', '41.75.123.49:41263', '119.11.240.78:39156', '119.82.252.122:36182', '213.226.11.149:41878', '36.91.44.243:37927', '195.60.174.123:31869', '182.253.82.156:32927', '197.248.184.158:53281', '101.51.141.49:57977', '125.27.251.57:41425', '125.163.119.76:8080', '168.227.229.96:8888', '195.239.115.106:44413', '187.45.13.190:54963', '91.226.5.245:49576', '103.43.42.85:30477', '179.127.243.21:47006', '91.122.46.45:8081', '36.72.96.24:8080', '189.30.181.98:8080', '118.172.227.89:60035', '195.182.152.238:38178', '91.203.224.177:36731', '185.252.30.81:8080', '209.97.159.125:3128', '51.158.180.179:8811', '165.227.26.121:3128', '181.117.176.236:61358', '172.104.53.59:31028', '31.179.224.42:41869', '80.51.31.201:8080', '85.10.219.98:1080', '196.3.97.82:23500', '80.48.210.2:32434', '178.151.143.112:31260', '134.236.247.106:36398', '185.44.231.2:34244', '186.229.25.18:8080', '103.224.185.20:49242', '196.3.97.86:23500', '165.227.47.172:8118', '103.9.188.151:38439', '176.235.99.33:61648', '195.230.115.115:8080', '200.186.53.102:58855', '185.35.142.70:35432', '34.73.72.29:80', '177.10.201.170:35791', '95.154.104.147:34153', '203.160.190.250:61161', '109.111.138.239:53281', '118.175.207.183:42517', '144.91.80.38:443', '195.191.250.38:3128', '124.122.166.184:8213', '186.29.163.97:49787', '186.225.63.134:38459', '116.90.229.186:46674', '195.209.131.19:32510', '187.188.175.251:42305', '27.50.18.42:23500', '202.179.7.182:56506', '95.216.88.76:44630', '27.255.13.134:37336', '103.216.82.29:6666', '103.250.156.22:30093', '1.20.97.173:46790', '91.225.229.140:53281', '103.102.28.134:42469', '103.21.163.86:35101', '138.122.140.35:3128', '36.84.99.8:3128', '177.91.111.233:8080', '105.212.11.128:55459', '103.25.167.200:45469', '14.207.101.77:8213', '77.93.42.134:47803', '176.120.212.114:53281', '41.190.95.20:56167', '58.162.229.173:51536', '103.75.162.68:57856', '212.2.204.181:60725', '42.115.88.12:32503', '103.250.158.23:61219', '185.255.178.176:7787', '190.109.167.9:57608', '202.169.38.198:56154', '102.164.211.175:30792', '95.84.128.25:33765', '167.172.27.220:8118', '187.44.160.234:50588', '190.6.200.158:38256', '179.13.144.75:31758', '132.255.21.58:999', '31.31.109.100:53281', '89.163.209.145:8080', '182.16.166.86:47200', '85.10.219.102:1080', '41.217.219.49:54302', '34.95.213.240:80', '45.231.212.56:59688', '179.27.83.222:54260', '103.142.68.163:80', '117.252.64.207:39966', '144.76.214.155:1080', '200.35.49.89:43006', '178.213.130.101:52658', '88.87.90.107:8080', '185.134.23.196:80', '190.152.213.126:47399', '117.103.70.34:8080', '3.95.210.35:3128', '149.129.240.89:8080', '119.42.125.209:32148', '185.99.64.75:61503', '128.0.179.234:41258', '185.255.178.191:7787', '103.61.101.74:47177', '172.87.221.221:3128', '45.173.12.60:999', '213.6.28.66:8080', '168.131.152.123:3128', '183.81.157.217:8080', '157.230.33.240:3128', '83.54.205.4:8080', '41.66.76.87:8080', '110.139.145.197:8080', '45.77.203.169:3128', '123.200.20.242:58847', '45.167.172.78:45300', '185.189.199.75:23500', '119.47.91.243:8080', '91.220.166.148:39915', '92.86.10.42:42658', '196.22.221.97:41666', '41.78.243.194:53281', '186.46.120.230:59282', '45.188.156.154:8080', '91.211.122.94:46406', '45.225.188.94:36707', '190.166.249.44:37359', '124.41.240.43:49040', '103.216.82.199:6666', '41.169.151.90:46799', '186.248.170.82:53281', '37.120.192.154:8080', '191.102.123.150:53408', '182.253.189.28:8888', '178.75.21.109:36143', '212.90.168.150:52589', '36.67.7.33:45619', '182.16.171.42:30679', '94.153.169.22:59177', '177.137.203.178:60771', '191.240.152.131:80', '124.41.211.211:46709', '140.227.238.18:1000', '118.99.118.86:23500', '196.3.97.34:23500', '140.227.237.154:1000', '190.151.94.3:46615', '140.227.210.123:3128', '103.105.77.48:8181', '160.2.38.41:8080', '94.158.165.19:45915', '89.42.133.58:8080', '181.196.205.250:59430', '45.165.226.68:34456', '38.126.254.114:35794', '194.213.43.166:38170', '154.79.245.30:42289', '216.218.15.48:34377', '212.156.76.190:8080', '103.83.99.69:3128', '77.70.35.87:48198', '88.80.188.112:31028', '5.200.81.26:8080', '94.130.179.24:8008', '176.113.157.149:31195', '201.55.164.229:3128', '103.116.118.133:52156', '51.38.86.0:8080', '103.86.156.150:43122', '114.134.172.50:60664', '78.38.115.211:60490', '211.24.105.248:39784', '45.63.108.68:33938', '136.228.128.6:30554', '185.49.130.81:48377', '180.245.233.66:8080', '43.248.24.158:51166', '110.44.133.135:3128', '190.152.223.2:37994', '154.117.155.42:30096', '204.48.19.184:8080', '176.9.62.77:80', '103.31.227.27:8080', '66.97.42.99:3128', '115.124.78.142:38994', '194.15.36.81:3128', '3.124.80.57:80', '45.76.186.203:3128', '88.135.210.179:8080', '164.163.1.30:38389', '167.172.188.118:3128', '190.152.125.250:43133', '192.140.42.83:50108', '103.83.116.218:55443', '80.187.140.26:8080', '45.171.248.82:8080', '201.204.168.106:63141', '31.180.250.53:8080', '163.172.180.18:8811', '129.226.77.75:10000', '47.241.65.148:3128', '181.118.167.104:80', '45.115.171.252:41945', '163.172.146.119:8811', '78.38.111.253:8080', '34.249.53.25:8080', '85.185.159.98:8080', '203.19.88.51:80', '212.29.236.66:80', '51.158.98.121:8811', '150.95.131.174:3128', '78.38.111.252:8080', '185.104.252.9:9090', '85.15.200.145:32108', '78.62.214.242:60678', '1.32.59.217:46162', '77.38.220.239:8080', '95.68.30.207:53281', '84.15.143.111:32829', '94.242.213.96:8118', '82.135.148.201:8081', '212.142.116.146:38523', '109.75.67.59:44151', '109.75.67.91:44151', '154.66.110.90:57393', '154.73.109.121:53281', '154.73.108.173:53281', '62.205.225.23:8080', '78.60.203.75:40494', '94.232.126.225:48235', '77.28.96.206:56644', '146.255.68.20:51329', '41.217.217.60:36120', '201.132.92.130:52800', '37.26.136.181:58930', '92.114.234.206:46685', '93.116.185.57:36471', '93.117.72.27:32468', '202.21.98.150:60640', '41.223.155.118:53281', '103.81.114.182:53281', '37.111.42.210:8080', '187.188.182.107:35636', '202.166.196.34:50076', '41.72.203.66:40231', '41.217.219.53:31398', '41.75.123.49:41263', '41.216.230.148:44795', '41.217.219.49:49072', '175.139.190.165:52890', '217.64.109.231:45282', '195.158.109.248:50330', '41.60.236.234:6833', '197.231.186.148:44728', '180.211.193.74:40536', '129.204.29.130:8080', '201.193.180.14:39675', '168.228.51.197:51240', '186.42.97.58:56691', '109.75.46.202:60048', '103.112.39.206:50135', '190.166.249.44:37359', '190.167.215.170:52479', '35.194.149.184:1080', '93.185.96.61:43749', '109.238.222.5:58250', '31.209.110.159:31019', '31.209.96.50:57482', '58.96.135.93:8080', '95.168.96.42:34273', '170.81.35.26:36681', '203.196.32.61:45305', '186.15.233.218:45999', '115.127.114.76:32343', '110.167.30.50:8060', '86.57.181.122:51078', '203.223.41.34:57897', '96.9.69.164:53281', '119.82.253.175:31500', '119.82.252.29:35467', '196.2.10.31:59117', '196.2.10.31:44763', '196.2.14.250:51929', '109.175.29.2:57980', '62.182.114.164:53309', '185.50.56.230:32231', '212.95.180.50:53281', '83.228.74.251:50371', '170.247.203.48:48263', '36.233.171.23:80', '179.108.123.210:33312', '96.9.86.70:52994', '41.211.126.224:61255', '190.151.94.3:46615', '93.125.22.31:3128',]
# print("random item from list is: ", random.choice(numberList))


main_path_data = os.path.abspath("./data")
f = open(main_path_data + "\\regim.json")
regim = json.load(f)


ff = open(main_path_data + "\\commis.json")
compp = json.load(ff)




# #
# # print(com['main']['hot'])
#
# main_path_data = os.path.abspath("./data")

# f.close()
# print("Before:", compp)
#
# compp['main']["alfa"] = 999
#
# f = open(main_path_data + "\\commis.json", "w")
# json.dump(compp, f)
# f.close()
# print("After: ", compp)

# filter = pd.read_csv('all_cards.csv')
final = pd.read_csv(main_path_data + "\\final.csv")

result = final[(final['birga_x'] == regim['1']['birga1']) &
               (final['birga_y'] == regim['1']['birga2']) &
               (final['valin_x'] == regim['1']['val1']) &
               (final['valout_x'] == regim['1']['val2']) &
               (final['valin_y'] == regim['1']['val2']) &
               (final['valout_y'] == regim['1']['val3'])]


var1 = result[result["valin_x"].isin(["USD", "USDT"])]
var2 = result[result["valin_y"].isin(["USD", "USDT"])]
var3 = result[(result["valin_x"] == "BTC") & (~result["valin_y"].isin(["USD", "USDT"]))]
var4 = result[(result["valin_y"] == "BTC") & (~result["valin_x"].isin(["USD", "USDT"]))]


var = {'var1': var1, 'var2': var2, 'var3': var3, 'var4': var4}

def calc1(result):
    result['start'] = "100"
    result["start"] = result["start"].str.replace(",","").astype(float)
    result["rates_x"] = result["rates_x"].str.replace(",","").astype(float)
    result["rates_y"] = result["rates_y"].str.replace(",","").astype(float)
    result['step'] = (result['start']) / (float(result['rates_x'] * compp['main'][result.iloc[0]['birga_x']]))
    result['back'] = result['step'] * (float(result['rates_y']) / compp['main'][result.iloc[0]['birga_y']])
    result['profit'] = result['back'] - result['start']
    result['perc'] = (((result['profit'])/(result['start'])) * 100)
    return result
def calc2(result):

    result['start'] = "100"
    result["start"] = result["start"].str.replace(",","").astype(float)
    result["rates_x"] = result["rates_x"].str.replace(",","").astype(float)
    result["rates_y"] = result["rates_y"].str.replace(",","").astype(float)
    result['step'] = (result['start']) * (float(result['rates_x'] / compp['main'][result.iloc[0]['birga_x']]))
    result['back'] = result['step'] / (float(result['rates_y']) * compp['main'][result.iloc[0]['birga_y']])
    result['profit'] = result['back'] - result['start']
    result['perc'] = (((result['profit'])/(result['start'])) * 100)

    return result
dfs = pd.DataFrame()
for i, v in var.items():
    if v.shape[0] > 0:
        if i == 'var1' or i == 'var3':
            dfs = dfs.append(calc1(v))
        else:
            dfs = dfs.append(calc1(v))
print(dfs)



